# 🔄 MPN Alternative Products Analysis

---

## 📄 ENG: Overview
This repository contains SQL scripts designed for **Databricks / Spark SQL** to analyze and compare replacement products with alternative products.  
The queries calculate price differences, margin differences, and shipping differences, providing insights for inventory, procurement, and pricing decisions.

---

## 📌 Project Overview

The main SQL script demonstrates:

- Joining multiple inventory and product tables.
- Comparing replacement products (specific manufacturer) with alternatives from other manufacturers.
- Calculating:
  - Price difference and percentage
  - Item margin difference and percentage
  - Shipping margin difference and percentage
  - Total margin and margin differences
- Filtering products by manufacturer and non-zero price.
- Handling complex joins including OE parts and product mappings.
- Safe calculations avoiding division by zero using `NULLIF`.

---

## 🛠 Key Skills Demonstrated

- SQL for complex data transformations
- Databricks / Spark SQL
- Multi-table joins and subqueries
- Financial calculations (price, margin, shipping)
- Data analysis for inventory and vendor comparison
- Writing readable and maintainable SQL with comments
---

## 💼 Portfolio Highlight

This repository is a **portfolio example** demonstrating ability to:

- Work with large, complex inventory and vendor datasets
- Perform advanced SQL calculations for business insights
- Structure SQL code for readability, maintainability, and scalability
- Document queries professionally for sharing and collaboration

---

## 📄 DE: Übersicht

---
Dieses Repository enthält SQL-Skripte für **Databricks / Spark SQL** zur Analyse und zum Vergleich von Ersatzprodukten mit Alternativprodukten.
Die Abfragen berechnen Preisunterschiede, Margenunterschiede und Versandunterschiede und liefern Erkenntnisse für Bestands-, Beschaffungs- und Preisentscheidungen.

---

## 📌 Projektübersicht

Das Haupt-SQL-Skript demonstriert:
- Verknüpfung mehrerer Bestands- und Produkttabellen.
- Vergleich von Ersatzprodukten (bestimmter Hersteller) mit Alternativen anderer Hersteller.
- Berechnung von:
  - Preisunterschied und Prozentsatz
  - Artikelmargenunterschied und Prozentsatz
  - Versandmargenunterschied und Prozentsatz
  - Gesamtmarge und Margenunterschiede
- Filtern von Produkten nach Hersteller und Preis ungleich Null.
- Handhabung komplexer Verknüpfungen, einschließlich OE-Teilen und Produktzuordnungen.
- Sichere Berechnungen ohne Division durch Null mithilfe von „NULLIF“.

---

## 🛠 Wichtige Fähigkeiten

- SQL für komplexe Datentransformationen
- Databricks / Spark SQL
- Multi-Table-Joins und Unterabfragen
- Finanzielle Berechnungen (Preis, Marge, Versand)
- Datenanalyse für Bestands- und Lieferantenvergleiche
- Schreiben von lesbarem und wartungsfreundlichem SQL mit Kommentaren
---

## 💼 Portfolio-Highlight

Dieses Repository ist ein **Portfolio-Beispiel** und demonstriert folgende Fähigkeiten:

- Arbeiten mit großen, komplexen Bestands- und Lieferantendatensätzen
- Durchführen von erweiterten SQL-Berechnungen für Geschäftseinblicke
- Strukturieren von SQL-Code für Lesbarkeit, Wartung und Skalierbarkeit
- Professionelles Dokumentieren von Abfragen für die gemeinsame Nutzung und Zusammenarbeit
